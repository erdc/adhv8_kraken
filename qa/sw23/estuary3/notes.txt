This needs to be updated for new code - cjt
